import { Meta, Canvas, Controls } from '@storybook/addon-docs/blocks';
import { CryptoIcon } from '@ledgerhq/crypto-icons';
import { Box } from '../Utility';
import * as NavBarStories from './NavBar.stories';
import {
  NavBar,
  NavBarBackButton,
  NavBarTitle,
  NavBarDescription,
  NavBarCoinCapsule,
} from './NavBar';
import {
  CustomTabs,
  Tab,
  DoVsDontRow,
  DoBlockItem,
  DontBlockItem,
} from '../../../../.storybook/components';
import CommonRulesDoAndDont from '../../../../.storybook/components/DoVsDont/CommonRulesDoAndDont.mdx';

<Meta title='Navigation/NavBar' of={NavBarStories} />

# NavBar

<CustomTabs>
  <Tab label="Overview">

## Introduction

The NavBar component provides navigation controls at the top of your screen. It supports three layouts: compact for standard navigation, expanded for more context, and with-asset for displaying cryptocurrency information.

> View in [Figma](https://www.figma.com/design/JxaLVMTWirCpU0rsbZ30k7/2.-Components-Library).

## Anatomy

<Canvas of={NavBarStories.Base} />

- **NavBar**: Root container that provides appearance context
- **NavBarBackButton**: Back navigation button with arrow icon
- **NavBarTitle**: The main heading text (required)
- **NavBarDescription**: Optional subtitle for additional context
- **NavBarCoinCapsule**: Cryptocurrency display with icon and ticker (for `with-asset` appearance)

## Properties

### Appearance: Compact

The default compact layout centers the title and description horizontally.

<Canvas of={NavBarStories.Base} />
<Controls of={NavBarStories.Base} />

### Appearance: Expanded

The expanded layout provides more vertical space with left-aligned content.

<Canvas of={NavBarStories.Expanded} />

### Appearance: With Asset

Special layout for displaying cryptocurrency or asset information.

<Canvas of={NavBarStories.WithAsset} />

## Text Truncation

Titles and descriptions automatically truncate when content exceeds available space.

<Canvas of={NavBarStories.TruncationShowcase} />

> **Key behaviors:**
>
> - **Compact**: Title and description truncate to one line, centered
> - **Expanded**: Title and description truncate to one line, left-aligned
> - Back button and trailing actions maintain fixed sizes

## Accessibility

React Native NavBar includes:

- Touch targets sized appropriately for mobile interaction
- Text truncation with ellipsis for long content
- Screen reader support through React Native's accessibility features
- Descriptive labels for icon buttons

</Tab>
<Tab label="Implementation">

## Setup

Install and set up the library with our [Setup Guide â†’](?path=/docs/getting-started-setup--docs).

## Basic Usage

```tsx
import {
  NavBar,
  NavBarBackButton,
  NavBarTitle,
  NavBarDescription,
} from '@ledgerhq/lumen-ui-rnative';

<NavBar appearance='compact'>
  <NavBarBackButton onPress={() => navigation.goBack()} />
  <NavBarTitle>Page Title</NavBarTitle>
</NavBar>;
```

## With Description

```tsx
<NavBar appearance='expanded'>
  <NavBarBackButton onPress={() => navigation.goBack()} />
  <NavBarTitle>Account Details</NavBarTitle>
  <NavBarDescription>View and manage your account</NavBarDescription>
</NavBar>
```

## With Trailing Actions

```tsx
import { MoreHorizontal } from '@ledgerhq/lumen-ui-rnative/symbols';
import { IconButton } from '@ledgerhq/lumen-ui-rnative';

<NavBar appearance='compact'>
  <NavBarBackButton onPress={() => navigation.goBack()} />
  <NavBarTitle>Settings</NavBarTitle>
  <IconButton
    appearance='no-background'
    size='md'
    icon={MoreHorizontal}
    accessibilityLabel='More options'
    onPress={() => showMenu()}
  />
</NavBar>;
```

## With Cryptocurrency Asset

```tsx
import { CryptoIcon } from '@ledgerhq/crypto-icons';
import { NavBarCoinCapsule } from '@ledgerhq/lumen-ui-rnative';

<NavBar appearance='with-asset'>
  <NavBarBackButton onPress={() => navigation.goBack()} />
  <NavBarCoinCapsule
    ticker='BTC'
    icon={<CryptoIcon ledgerId='bitcoin' ticker='BTC' size={24} />}
  />
</NavBar>;
```

## Integration with React Navigation

The NavBar integrates seamlessly with React Navigation's header options:

```tsx
import { NavBar, NavBarBackButton, NavBarTitle } from '@ledgerhq/lumen-ui-rnative';
import { createNativeStackNavigator } from '@react-navigation/native-stack';

const Stack = createNativeStackNavigator();

function App() {
  return (
    <Stack.Navigator
      screenOptions={{
        header: ({ navigation, route }) => (
          <NavBar appearance='compact'>
            <NavBarBackButton onPress={() => navigation.goBack()} />
            <NavBarTitle>{route.name}</NavBarTitle>
          </NavBar>
        ),
      }}
    >
      <Stack.Screen name='Home' component={HomeScreen} />
      <Stack.Screen name='Details' component={DetailsScreen} />
    </Stack.Navigator>
  );
}
```

## Integration with Expo Router

For Expo Router, use the NavBar in your layout files:

```tsx
// app/_layout.tsx
import { Stack } from 'expo-router';
import { NavBar, NavBarBackButton, NavBarTitle } from '@ledgerhq/lumen-ui-rnative';
import { useRouter } from 'expo-router';

export default function Layout() {
  const router = useRouter();

  return (
    <Stack
      screenOptions={{
        header: ({ route }) => (
          <NavBar appearance='compact'>
            <NavBarBackButton onPress={() => router.back()} />
            <NavBarTitle>{route.name}</NavBarTitle>
          </NavBar>
        ),
      }}
    />
  );
}
```

Or for a specific screen:

```tsx
// app/details.tsx
import { Stack } from 'expo-router';
import { NavBar, NavBarBackButton, NavBarTitle } from '@ledgerhq/lumen-ui-rnative';
import { useRouter } from 'expo-router';

export default function DetailsScreen() {
  const router = useRouter();

  return (
    <>
      <Stack.Screen
        options={{
          header: () => (
            <NavBar appearance='expanded'>
              <NavBarBackButton onPress={() => router.back()} />
              <NavBarTitle>Details</NavBarTitle>
              <NavBarDescription>View detailed information</NavBarDescription>
            </NavBar>
          ),
        }}
      />
      {/* Your screen content */}
    </>
  );
}
```

## Do's and Don'ts

<div className='flex flex-col gap-24'>
  <DoVsDontRow>
    <DoBlockItem
      title='Use appropriate appearance'
      description='Choose the appearance that best fits your content needs'
    >
      {/* prettier-ignore */}
      ```tsx
      // Compact for simple navigation
      <NavBar appearance='compact'>
        <NavBarBackButton onPress={goBack} />
        <NavBarTitle>Settings</NavBarTitle>
      </NavBar>

      // Expanded for more context
      <NavBar appearance='expanded'>
        <NavBarBackButton onPress={goBack} />
        <NavBarTitle>Account</NavBarTitle>
        <NavBarDescription>Manage your preferences</NavBarDescription>
      </NavBar>
      ```
    </DoBlockItem>
    <DontBlockItem
      title="Don't mix incompatible children"
      description='with-asset appearance should only use NavBarCoinCapsule, not title/description'
    >
      {/* prettier-ignore */}
      ```tsx
      // Wrong: Using title with with-asset
      <NavBar appearance='with-asset'>
        <NavBarBackButton onPress={goBack} />
        <NavBarTitle>Bitcoin</NavBarTitle>
      </NavBar>

      // Correct: Use NavBarCoinCapsule
      <NavBar appearance='with-asset'>
        <NavBarBackButton onPress={goBack} />
        <NavBarCoinCapsule ticker='BTC' icon={icon} />
      </NavBar>
      ```
    </DontBlockItem>
  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Keep titles concise'
      description='Use short, clear titles that work well when truncated'
    >
      {/* prettier-ignore */}
      ```tsx
      <NavBar appearance='compact'>
        <NavBarBackButton onPress={goBack} />
        <NavBarTitle>Settings</NavBarTitle>
      </NavBar>
      ```
    </DoBlockItem>
    <DontBlockItem
      title="Don't use overly long titles"
      description='Long titles will truncate and lose important information'
    >
      {/* prettier-ignore */}
      ```tsx
      <NavBar appearance='compact'>
        <NavBarBackButton onPress={goBack} />
        <NavBarTitle>
          Account Settings and Preferences Configuration
        </NavBarTitle>
      </NavBar>
      ```
    </DontBlockItem>
  </DoVsDontRow>

  <DoVsDontRow>
    <DoBlockItem
      title='Provide onPress handlers'
      description='Always implement navigation actions for interactive elements'
    >
      {/* prettier-ignore */}
      ```tsx
      <NavBar appearance='compact'>
        <NavBarBackButton 
          onPress={() => navigation.goBack()} 
        />
        <NavBarTitle>Details</NavBarTitle>
      </NavBar>
      ```
    </DoBlockItem>
    <DontBlockItem
      title="Don't omit onPress handlers"
      description='NavBarBackButton needs onPress to handle navigation'
    >
      {/* prettier-ignore */}
      ```tsx
      <NavBar appearance='compact'>
        <NavBarBackButton />
        <NavBarTitle>Details</NavBarTitle>
      </NavBar>
      ```
    </DontBlockItem>
  </DoVsDontRow>
</div>

<CommonRulesDoAndDont />

</Tab>
</CustomTabs>
